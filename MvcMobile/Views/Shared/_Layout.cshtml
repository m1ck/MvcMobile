@{
    char[] alpha = "ABCDEFGHIJKLMNOPQRSTUVWXYZ".ToCharArray();    
}

<!DOCTYPE html> 
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<title>GSU Directory</title> 
	        <link href="@System.Web.Optimization.BundleTable.Bundles.ResolveBundleUrl("~/Content/css")" rel="stylesheet" type="text/css" />
           <script src="@System.Web.Optimization.BundleTable.Bundles.ResolveBundleUrl("~/Scripts/js")"></script>
 
 	
    <script src="@Url.Content("~/Scripts/dust-full-0.3.0.min.js")" type="text/javascript"></script>

<style type="text/css" >
	.ui-page {
    -webkit-backface-visibility: hidden;
}
	
	
	.ui-page * {
-webkit-transform: rotateY(0deg);
-moz-transform: rotateY(0deg);
transform: rotateY(0deg);
}
	
	</style> 
	<script type="text/javascript">


        var delay = (function(){
          var timer = 0;
          return function(callback, ms){
            clearTimeout (timer);
            timer = setTimeout(callback, ms);
          };
        })();

	    $(document).bind("mobileinit", function () {
	        $.mobile.touchOverflowEnabled = true;
	    });


	    $(document).ready(function () {
	        $("input[id^='search']").keyup(function () { delay(function(){
                  ajaxsearch(); }, 500 );            
             });
            $('#searchform').submit(function() {
                    //ajaxsearch();
                    //$('#target').blur();
                    document.searchform.criteria.value = $("#selectcriteria").val();
                    $('#criteria').val( $("#selectcriteria").val());
                    document.getElementById('criteria').value = $("#selectcriteria").val();
                    document.forms["searchform"].submit();
                      
                     
                   return false;
            });
	    });


	    function ajaxsearch() {
	        namelst = $("#search").val();
	        $.getJSON("http://netdevone.gsu.edu/directory/api/Person?givenName="+ namelst +"&sn=", displayEmployee);
	    }


	    $('#detailsPage').live('pagebeforeshow', function (event , data) {
         //alert(event.currentTarget.dataset.url);
	        var id = getUrlVar(event.currentTarget.dataset.url)["id"];
             //var campusid = id;
             //var id = getUrlVar()["id"];
            //$('a').live('click', function(e) {
             //  campusid = $(e.target).jqmData("campusid");               
               // $.getJSON("http://netdevone.gsu.edu/directory/api/Person/" + campusid, displayEmployeeDetail);
            //  }
            // )
         
	       $.getJSON("http://netdevone.gsu.edu/directory/api/Person/"+id, displayEmployeeDetail);
	    });



	    function displayEmployee(data) {
	        var employee = data.item;
	        //var source ="{#items}<li><a href='#two?id={id}'><h4>{firstName} {lastName}</h4><p>{title}</p><span class='ui-li-count'>{reportCount}</span></a></li>{/items}";
	        // $("#actionListTemplate" ).tmpl( employee ).appendTo( "#actionList" );



	        //var source ="{#items2}<li><a href='#detailsPage?id={id}' data-transition='slide'>{firstName} {lastName}</a></li>{/items2}";

	        var source = "{?A}\n" +
                "<li data-role='list-divider'>A</li>" +
                "    {#A}\n" +
                "      {~s} <li><a href='#detailsPage?id={sn}' data-transition='slide'>{cn} </a></li>{~n}\n" +
                "    {/A}\n" +
                "{:else}\n" +
                "  No Tags!\n" +
                "{/A}\n" +
                "{~n}\n" +
                "{^B}\n" +
                "  No Likes!\n" +
                "{:else}\n" +
                "<li data-role='list-divider'>b</li>" +
                "    {#B}\n" +
                "      {~s} <li><a href='#detailsPage?id={sn}' data-transition='slide'>{cn} </a></li>{~n}\n" +
                "    {/B}\n" +
                "{/B}" +
                "{~n}\n" +
                "{^C}\n" +
                "  No Likes!\n" +
                "{:else}\n" +
                "<li data-role='list-divider'>C</li>" +
                "    {#C}\n" +
                "      {~s} <li><a href='#detailsPage?id={sn}' data-transition='slide'>{cn} </a></li>{~n}\n" +
                "    {/C}\n" +
                "{/C}";
                 var source2 =" @foreach (var ltr in alpha)
                 {                    
                       @Html.Raw("{~n}{^")@ltr@Html.Raw("}" );
                       @Html.Raw(" " );
                       @Html.Raw("{:else}" );
                       @Html.Raw("<li data-role='list-divider'>" );@ltr @Html.Raw("</li>" );
                       @Html.Raw("{#"); @ltr  @Html.Raw("}" );
                       @Html.Raw("{~s} <li><a href='#detailsPage?id={eduPersonPrincipalName}'  data-campusid='{eduPersonPrincipalName}' data-transition='slide'>{cn} </a></li>{~n}" );
                       @Html.Raw("{/"); @ltr  @Html.Raw("}" );
                       @Html.Raw("{/"); @ltr  @Html.Raw("}" );                      
                       @Html.Raw("{~n}" );
                 } ";    

	        dust.loadSource(dust.compile(source2, "array"));
	        dust.render("array", data[0], function (err, out) {
	            $("#actionList").html(out);
	        });
	        $('#actionList').listview('refresh');
	    }


           
	    function displayEmployeeDetail(data) {
       
	        var employee = data.item;
	        //var source ="{#items}<li><a href='#two?id={id}'><h4>{firstName} {lastName}</h4><p>{title}</p><span class='ui-li-count'>{reportCount}</span></a></li>{/items}";
	        // $("#actionListTemplate" ).tmpl( employee ).appendTo( "#actionList" );
	        var source = "<b>{cn} <br/> {sn} </b>";
	        dust.loadSource(dust.compile(source, "replace"));
	        dust.render("replace", data[0], function (err, out) {
	            $("#employeeDetails").html(out);
	        });
	       // $('#employeeDetails').listview('refresh');
	    }


	    ///////////////////////////////////////////////////////////////////////////////////////////////////////////////
	    function getUrlVars() {
	        var vars = [], hash;
	        var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
	        for (var i = 0; i < hashes.length; i++) {
	            hash = hashes[i].split('=');
	            vars.push(hash[0]);
	            vars[hash[0]] = hash[1];
	        }
	        return vars;
	    }

         ///////////////////////////////////////////////////////////////////////////////////////////////////////////////
	    function getUrlVar(url) {
	        var vars = [], hash;
	        var hashes = url.slice(url.indexOf('?') + 1).split('&');
	        for (var i = 0; i < hashes.length; i++) {
	            hash = hashes[i].split('=');
	            vars.push(hash[0]);
	            vars[hash[0]] = hash[1];
	        }
	        return vars;
	    }

 </script>
</head> 

	
<body> 



	<div data-role="page" class="type-interior">

		<div data-role="header" data-theme="b"  data-id="foo"   >
	 
		<a href="../../" data-icon="home" data-iconpos="notext" data-direction="reverse" id="target">Home</a>
		 <h1>GSU Directory</h1>
	<span class="ui-btn-right ui-btn  ui-btn-corner-all">
    <select name="selectcriteria" id="selectcriteria" data-theme="b" data-icon="gear" data-inline="true" data-native-menu="false">
			<option value="view"></option>
			<option value="students" selected> Students</option>
			<option value="fands">Faculty Staff</option>
			<option value="depts">Departments</option>
		</select>
	  
	</span>
	  
	  @*   @using (Html.BeginForm("Index", "Search", FormMethod.Get, new {Id=12345,   @class = "form-stacked" }))
        { 
        *@
         @* Unable to use   data-ajax="false"  in the code so i had to hard code this*@
           <form  action="/mobile/directory/Search" class="form-stacked" data-ajax="false" name="searchform" id="searchform" method="get">				
        	   <input type="search" name="fname" id="search" value="@ViewBag.search_terms"  data-theme="d"  autocomplete="off" />
               <input type="hidden" value="all" name="criteria" id="criteria" />
           </form>
          @*   }  *@
	  </div>
	
	  <div data-role="content">
				@RenderBody()
		   </div><!--/content-primary -->
	  </div><!-- /page -->
	
	
	
	
	
	<div id="detailsPage" data-role="page" data-add-back-btn="true" >

	        <div data-role="header" data-theme="b">
		        <h1> Details </h1>
	        </div>

          <div data-role="content"> 

      	<a href='#' data-role='button' data-rel='dialog' id="employeeDetails" ></a>


          

  </div>

</div>